//============================================================================
// Name        : ImagePreprocessor.cpp
// Author      : Nate Sutton
// Version     :
// Copyright   : Your copyright notice
// Description : Hello World in C++, Ansi-style
// from http://docs.opencv.org/doc/tutorials/introduction/display_image/display_image.html
//============================================================================

#include <opencv2/core/core.hpp>
#include <opencv2/imgcodecs.hpp>
#include <opencv2/highgui/highgui.hpp>

#include <iostream>
#include <string>

using namespace cv;

using namespace std;

int main(int argc, char** argv) {
    //! [load]
    const char imageName[19] = "breastsOutline.jpg"; // by default
    const cv::String imageName3 = "/home/nmsutton/Documents/Software/OpenGL/BodyMaker2/BodyMaker2/breasts2.bmp";
    String imageName4 = "/home/nmsutton/Documents/Software/OpenGL/BodyMaker2/BodyMaker2/breastsOutline.jpg";
    String imageName5 = "/home/nmsutton/Documents/Software/OpenGL/BodyMaker2/ImagePreprocessor/src/blank.jpg";
    String imageName6 = "/home/nmsutton/Documents/Software/OpenGL/BodyMaker2/ImagePreprocessor/src/breastsOutline2.jpg";
    /*if( argc > 1)
    {
        imageName = argv[1];
    }*/
    //! [load]

    //! [mat]
    Mat image;
    //image = imread( "breastsOutline.jpg", 1 );
    //! [mat]

    //! [imread]
    //image = imread(imageName.c_str(), IMREAD_COLOR); // Read the file
    //Mat imread(const String& filename, int flags=IMREAD_COLOR );
    //Mat image2 = imread(const String& imageName3, int flags=IMREAD_COLOR );
    //image = imread("breastsOutline.jpg", CV_LOAD_IMAGE_COLOR);
    //image = imread(const String& imageName, int flags=CV_LOAD_IMAGE_COLOR);


    image = imread(imageName6, CV_LOAD_IMAGE_COLOR);
    //image = imread(imageName3, 0); //greyscale


    //image = imread("breastsOutline.jpg", 1);
    //IplImage *img=cvLoadImage("brain_mri_00%j.jpg", CV_LOAD_IMAGE_GRAYSCALE);
    //CvMat* cvLoadImageM(const char* imageName, int iscolor=CV_LOAD_IMAGE_COLOR);
    //! [imread]

    for(int y=0;y<image.rows;y++)
    {
      for (int x=0;x<image.cols;x++)
      {
        //if( i== j)
    	//if((j%18==0|j%19==0|j%20==0|j%21==0|j%21==0)&&(i%18==0|i%19==0|i%20==0|i%21==0|i%22==0))
    	  /*if (image.at<Vec3b>(j,i) == Vec3b(0,0,0)) {
    		  image.at<Vec3b>(j,i) = 200;
    	  }*/
    	  /*if (image.at<Vec3b>(x,y) == Vec3b(255,255,255)) {
    	      image.at<Vec3b>(x,y) = 200;
    	  }*/
    	  bool anchorXAxisFound = false;
    	  if ((image.at<Vec3b>(y,x) == Vec3b(0,0,0)) &
    		  ((x+11) < image.cols) &
			  (image.at<Vec3b>(y,(x+10)) == Vec3b(255,255,255))) {
    		  for (int i2 = 0;i2<10;i2++) {
    			  image.at<Vec3b>(y,x+i2) = 200;
    		  }
    		  for (int x2=x+100;x2<(image.cols/2);x2++) {
    			  // find first occuring limited line segment.
    			  if (image.at<Vec3b>(y,x2) == Vec3b(0,0,0)) {
    				  for (int x3=x;x3<x2;x3++) {
    					  if ((x3%5==0) & (anchorXAxisFound == false)) {
    						  image.at<Vec3b>(y,x3) = Vec3b(0,255,0);
    					  }
    				  }
    				  anchorXAxisFound = true;
    			  }
    		  }
    	  }
    	  /*if(i%15==0&j%15==0)
        	image.at<Vec3b>(j,i) = 100; //white*/
    	//image.
    	//image.at<uchar>(j,i) = 0;
    	//image.at<Vec3b>(i,j) = 0;
    	//cout<<image.at<uchar>(j,i);cout<<"\n";
      }
    }
    cout<<"rows";
    cout<<image.rows;
    cout<<"\n";
    cout<<"cols";
	cout<<image.cols;
	cout<<"\n";
    //After changing
    //cv::imshow("After",img);

    namedWindow( "Display Image", CV_WINDOW_AUTOSIZE );
      imshow( "Display Image", image );

      waitKey(0);



    /*if( image.empty() )                      // Check for invalid input
    {
        cout <<  "Could not open or find the image" << std::endl ;
        //cv::waitKey(5000);
        return -1;
    }

    //! [window]
    //namedWindow( "Display window", WINDOW_AUTOSIZE ); // Create a window for display.
    int cvNamedWindow(const char* name, int flags=CV_WINDOW_AUTOSIZE );
    //! [window]

    //! [imshow]
    //imshow( "Display window", image );                // Show our image inside it.
    void cvShowImage(const char* name, const CvArr* image);
    //! [imshow]

    //! [wait]
    //waitKey(0); // Wait for a keystroke in the window
    //int cvWaitKey(int delay=0 );
    cv::waitKey(5000);
    int cvWaitKey(int delay=5000 );
    //! [wait]*/
	cout << "done";
    return 0;
}
